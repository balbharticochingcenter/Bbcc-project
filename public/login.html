
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBCC Portal - Login</title>
    <link rel="stylesheet" href="/css/login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta name="google-site-verification" content="TvuSNz7Vm9cM9S0ZWzwTe1ioc_o1hd3S3Wsm4QH651c" />
</head>
<body>
   
    <div class="loader-container" id="loader">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <header class="main-header">
        <div class="header-content">
           <div class="header-left">
                <div class="coin-container">
                    <div class="coin-inner">
                        <div class="coin-front">
                            <img id="header-logo" src="" alt="Logo" class="coin-img">
                        </div>
                        <div class="coin-back">
                            <div class="admission-text">ADMISSION<br>OPEN</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="header-center">
                <h1 id="header-title" class="magical-text"></h1>
                <h2 id="header-subtitle" class="magical-text"></h2>
            </div>
            <div class="header-right">
                <button id="loginBtn" class="btn result-button login-btn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button id="studentRegBtn" class="btn result-button reg-btn">
                    <i class="fas fa-user-plus"></i> Register
                </button>
                <button id="studentResultBtn" class="btn result-button result-btn">
                    <i class="fas fa-poll"></i> Check Result
                </button>
            </div>
        </div>
    </header>

    <div class="slider-container">
        <div id="dynamic-slider" class="slider-wrapper">
            <div class="slide-placeholder">
                <i class="fas fa-spinner fa-spin"></i> Loading Slider Photos...
            </div>
        </div>
        <button class="slider-btn prev" onclick="moveSlider(-1)">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="slider-btn next" onclick="moveSlider(1)">
            <i class="fas fa-chevron-right"></i>
        </button>
        <div class="slider-indicators" id="sliderIndicators"></div>
    </div>

    <section class="vip-section">
        <h2>Bal Bharti Coaching Center ‚Äì Madhubani</h2>
        <p class="vip-subtitle">
            Madhubani ka sabse trusted coaching for <b>Class 1st to 10th</b> ‚Äì All Subjects ‚Äì Online & Offline
        </p>

        <div class="vip-grid">
            <div onclick="openVip('vip1')" class="vip-grid-item">
                <i class="fas fa-school"></i>
                <span>About BBCC</span>
            </div>
            <div onclick="openVip('vip2')" class="vip-grid-item">
                <i class="fas fa-star"></i>
                <span>Why Choose Us</span>
            </div>
            <div onclick="openVip('vip3')" class="vip-grid-item">
                <i class="fas fa-book-open"></i>
                <span>Classes 1‚Äì10</span>
            </div>
            <div onclick="openVip('vip4')" class="vip-grid-item">
                <i class="fas fa-book"></i>
                <span>Subjects</span>
            </div>
            <div onclick="openVip('vip5')" class="vip-grid-item">
                <i class="fas fa-trophy"></i>
                <span>Results</span>
            </div>
            <div onclick="openVip('vip6')" class="vip-grid-item">
                <i class="fas fa-laptop"></i>
                <span>Online Classes</span>
            </div>
            <div onclick="openVip('vip7')" class="vip-grid-item">
                <i class="fas fa-chalkboard-teacher"></i>
                <span>Offline Coaching</span>
            </div>
            <div onclick="openVip('vip8')" class="vip-grid-item">
                <i class="fas fa-users"></i>
                <span>Teachers</span>
            </div>
            <div onclick="openVip('vip9')" class="vip-grid-item">
                <i class="fas fa-file-signature"></i>
                <span>Admission</span>
            </div>
            <div onclick="openVip('vip10')" class="vip-grid-item">
                <i class="fas fa-phone-alt"></i>
                <span>Contact</span>
            </div>
        </div>
    </section>

    <!-- VIP Popups -->
    <div id="vip1" class="vip-popup">
        <div class="vip-box">
            <span class="vip-close" onclick="closeVip('vip1')">&times;</span>
            <h2>Bal Bharti Coaching Center ‚Äì Madhubani</h2>
            <!-- Content unchanged -->
        </div>
    </div>

    <!-- Other VIP popups (same content, just optimized containers) -->
    <div id="vip2" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vip3" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vip4" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vip5" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vip6" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vip7" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vip8" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vipAdmission" class="vip-popup"><div class="vip-box">...</div></div>
    <div id="vip10" class="vip-popup"><div class="vip-box">...</div></div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content three-d-card login-modal-card">
            <span class="close-button" id="closeLogin">&times;</span>
            <div class="modal-header">
                <i class="fas fa-lock"></i>
                <h2>Secure Login</h2>
                <p class="modal-subtitle">Enter your credentials to access the portal</p>
            </div>
            <form id="loginForm">
                <div class="input-group">
                    <label for="userId">
                        <i class="fas fa-user"></i> User ID:
                    </label>
                    <input type="text" id="userId" name="userId" placeholder="Enter your User ID" required>
                </div>
                <div class="input-group">
                    <label for="password">
                        <i class="fas fa-key"></i> Password:
                    </label>
                    <input type="password" id="password" name="password" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="btn three-d-button submit-btn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <p id="loginMessage" class="error-message"></p>
            </form>
        </div>
    </div>

    <!-- Teacher Ring Section -->
    <section class="teacher-ring-section">
        <h2 class="section-title">
            <i class="fas fa-chalkboard-teacher"></i> Our Expert Teachers
        </h2>
        <div class="ring-container">
            <div id="teacher-ring" class="ring-track"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-info">
                <p><i class="fas fa-map-marker-alt"></i> <span id="footer-contact"></span></p>
                <p><i class="fas fa-phone"></i> <span id="footer-call"></span></p>
                <p><i class="fas fa-envelope"></i> <span id="footer-gmail"></span></p>
            </div>
            <div class="social-links">
                <a id="footer-facebook" href="#" target="_blank"><i class="fab fa-facebook-f"></i></a>
                <a id="footer-youtube" href="#" target="_blank"><i class="fab fa-youtube"></i></a>
                <a id="footer-instagram" href="#" target="_blank"><i class="fab fa-instagram"></i></a>
                <a id="footer-twitter" href="#" target="_blank"><i class="fab fa-twitter"></i></a>
            </div>
            <p id="footer-help" class="footer-help"></p>
            <p class="copyright">¬© 2024 Bal Bharti Coaching Center. All rights reserved.</p>
        </div>
    </footer>

    <!-- Result Modal -->
    <div id="resultModal" class="modal">
        <div class="modal-content three-d-card result-modal-card">
            <span class="close-button">&times;</span>
            <div class="modal-header">
                <i class="fas fa-search"></i>
                <h3>Search Student Result</h3>
                <p class="modal-subtitle">Enter ID or Name + Mobile to search</p>
            </div>
            <div class="search-form-group">
                <div class="input-group">
                    <label><i class="fas fa-user-graduate"></i> Student ID or Name:</label>
                    <input type="text" id="searchStudentId" placeholder="Enter ID or Full Name">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-mobile-alt"></i> Mobile Number:</label>
                    <input type="text" id="searchMobile" placeholder="Student/Parent Mobile">
                </div>
                <button id="searchStudentBtn" class="btn three-d-button search-btn">
                    <i class="fas fa-search"></i> Search Result
                </button>
            </div>
            <p id="searchMessage" class="error-message"></p>
            <div id="studentResultDisplay" class="student-result-display">
                <!-- Result display content -->
            </div>
        </div>
    </div>

    <!-- Registration Modal -->
    <div id="regModal" class="modal">
        <div class="modal-content three-d-card reg-modal-card">
            <span class="close-button" id="closeReg">&times;</span>
            <div class="modal-header">
                <i class="fas fa-user-plus"></i>
                <h3>Student Registration</h3>
                <p class="modal-subtitle">Fill details to register new student</p>
            </div>
            <form id="studentRegForm">
                <div class="form-container-box">
                    <!-- Form fields (unchanged) -->
                </div>
            </form>
        </div>
    </div>

    <!-- Bharti Float Button -->
    <div class="bharti-float-container">
        <span class="tooltip-text">Talk to Bharti</span>
        <a href="bharti.html" class="bharti-float-btn">
            <i class="fas fa-comment-dots"></i>
        </a>
    </div>

    <!-- Hidden elements -->
    <div id="detailedResultContent" style="display:none;"></div>
    <div id="alertBox" class="alert"></div>
    <div style="display:none">
        Bal Bharti Coaching Center Madhubani, Best coaching in Madhubani, Class 1 to 10 coaching Bihar...
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="/js/login.js"></script>
</body>
</html>
[file content end]

[file name]: login.css
[file content begin]
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap');

:root {
    --primary-color: #4a90e2;
    --secondary-color: #50e3c2;
    --accent-color: #f5a623;
    --success-color: #28a745;
    --warning-color: #ffc107;
    --danger-color: #dc3545;
    --dark-bg: #1a1a2e;
    --light-bg: #21213e;
    --card-bg: #2d2d44;
    --text-color: #e0e0e0;
    --text-light: #f8f9fa;
    --border-color: #3b3b5b;
    --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg, var(--dark-bg) 0%, #16213e 100%);
    color: var(--text-color);
    line-height: 1.6;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    overflow-x: hidden;
}

/* ====== LOADER ====== */
.loader-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(26, 26, 46, 0.95);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    color: var(--secondary-color);
    font-size: 1.2em;
}

.spinner {
    border: 8px solid rgba(255, 255, 255, 0.1);
    border-top: 8px solid var(--primary-color);
    border-radius: 50%;
    width: 70px;
    height: 70px;
    animation: spin 1.5s linear infinite;
    margin-bottom: 20px;
    box-shadow: 0 0 20px rgba(74, 144, 226, 0.4);
}

/* ====== HEADER ====== */
.main-header {
    background: linear-gradient(135deg, var(--light-bg) 0%, #2a2a4a 100%);
    padding: 15px 30px;
    border-bottom: 3px solid var(--primary-color);
    box-shadow: var(--shadow);
    position: sticky;
    top: 0;
    z-index: 100;
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 1400px;
    margin: 0 auto;
}

.header-left {
    display: flex;
    align-items: center;
}

.coin-container {
    width: 80px;
    height: 80px;
    perspective: 1000px;
    margin-right: 20px;
}

.coin-inner {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    animation: flipCoin 10s infinite linear;
}

.coin-front, .coin-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 3px solid #ffd700;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.coin-front {
    background: white;
}

.coin-img {
    width: 90%;
    height: 90%;
    border-radius: 50%;
    object-fit: contain;
    animation: logoGlow 2s ease-in-out infinite;
}

.coin-back {
    background: linear-gradient(45deg, #d41414, #ff4b2b);
    color: white;
    transform: rotateY(180deg);
    text-align: center;
}

.admission-text {
    font-size: 12px;
    font-weight: 900;
    line-height: 1.2;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
}

.header-center {
    text-align: center;
    flex-grow: 1;
}

.magical-text {
    background: linear-gradient(45deg, #ff00cc, #3333ff, #00ffcc, #ffcc00);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: waterWave 4s linear infinite;
    font-family: 'Orbitron', sans-serif;
    text-shadow: 0 0 20px rgba(74, 144, 226, 0.3);
}

#header-title {
    font-size: 2.8em;
    margin-bottom: 5px;
    letter-spacing: 1px;
}

#header-subtitle {
    font-size: 1.3em;
    opacity: 0.9;
}

.header-right {
    display: flex;
    gap: 15px;
}

.result-button {
    padding: 12px 25px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.1em;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.result-button::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -60%;
    width: 20%;
    height: 200%;
    background: rgba(255, 255, 255, 0.2);
    transform: rotate(30deg);
    animation: shineLine 3s infinite;
}

.login-btn {
    background: linear-gradient(135deg, var(--primary-color), #3a7bd5);
    color: white;
}

.reg-btn {
    background: linear-gradient(135deg, var(--success-color), #218838);
    color: white;
}

.result-btn {
    background: linear-gradient(135deg, var(--accent-color), #e69500);
    color: white;
}

.result-button:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

/* ====== SLIDER ====== */
.slider-container {
    width: 95%;
    max-width: 1300px;
    height: 400px;
    margin: 25px auto;
    position: relative;
    overflow: hidden;
    border-radius: 20px;
    border: 4px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
}

.slider-wrapper {
    display: flex;
    width: 100%;
    height: 100%;
    transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.slider-wrapper img {
    min-width: 100%;
    height: 100%;
    object-fit: cover;
}

.slide-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: linear-gradient(135deg, var(--dark-bg), var(--light-bg));
    color: var(--secondary-color);
    font-size: 1.5em;
}

.slide-placeholder i {
    font-size: 3em;
    margin-bottom: 20px;
}

.slider-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border: none;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
    z-index: 10;
}

.slider-btn:hover {
    background: var(--primary-color);
    transform: translateY(-50%) scale(1.1);
}

.prev { left: 20px; }
.next { right: 20px; }

.slider-indicators {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
}

.slider-indicators span {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: var(--transition);
}

.slider-indicators span.active {
    background: var(--primary-color);
    transform: scale(1.3);
}

/* ====== VIP SECTION ====== */
.vip-section {
    padding: 60px 20px;
    background: linear-gradient(135deg, #f8fbff 0%, #eef2f7 100%);
    text-align: center;
    margin: 30px 0;
}

.vip-section h2 {
    color: #003366;
    font-size: 2.5em;
    margin-bottom: 15px;
    position: relative;
}

.vip-section h2::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 4px;
    background: var(--primary-color);
    border-radius: 2px;
}

.vip-subtitle {
    color: #666;
    font-size: 1.2em;
    margin-bottom: 40px;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
}

.vip-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    max-width: 1200px;
    margin: 0 auto;
}

.vip-grid-item {
    background: white;
    padding: 25px 20px;
    border-radius: 15px;
    cursor: pointer;
    font-weight: bold;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    transition: var(--transition);
    border: 2px solid transparent;
}

.vip-grid-item i {
    font-size: 2.5em;
    color: var(--primary-color);
    margin-bottom: 5px;
}

.vip-grid-item span {
    font-size: 1.1em;
    color: #333;
}

.vip-grid-item:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 30px rgba(0,0,0,0.15);
    border-color: var(--primary-color);
    background: linear-gradient(135deg, #ffffff, #f0f7ff);
}

/* ====== VIP POPUPS ====== */
.vip-popup {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(5px);
    z-index: 9998;
    overflow-y: auto;
    animation: fadeIn 0.3s ease;
}

.vip-box {
    background: white;
    margin: 40px auto;
    padding: 30px;
    max-width: 900px;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    animation: slideUp 0.4s ease;
    position: relative;
}

.vip-close {
    position: absolute;
    top: 20px;
    right: 25px;
    font-size: 32px;
    cursor: pointer;
    color: var(--danger-color);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: var(--transition);
}

.vip-close:hover {
    background: #f8f9fa;
    transform: rotate(90deg);
}

/* ====== MODALS ====== */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.9);
    backdrop-filter: blur(10px);
    z-index: 9999;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease;
}

.modal-content {
    background: var(--card-bg);
    padding: 30px;
    border-radius: 20px;
    width: 90%;
    max-width: 500px;
    position: relative;
    animation: slideUp 0.4s ease;
    border: 2px solid var(--border-color);
    box-shadow: 0 25px 50px rgba(0,0,0,0.5);
}

.modal-header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--border-color);
}

.modal-header i {
    font-size: 3em;
    color: var(--primary-color);
    margin-bottom: 15px;
}

.modal-header h2, .modal-header h3 {
    color: var(--text-light);
    margin-bottom: 10px;
}

.modal-subtitle {
    color: var(--secondary-color);
    font-size: 0.95em;
}

.close-button {
    position: absolute;
    top: 20px;
    right: 25px;
    font-size: 32px;
    cursor: pointer;
    color: var(--danger-color);
    transition: var(--transition);
    z-index: 100;
}

.close-button:hover {
    transform: scale(1.2);
    color: #ff3333;
}

/* ====== FORMS ====== */
.input-group {
    margin-bottom: 25px;
    text-align: left;
}

.input-group label {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    color: var(--secondary-color);
    font-weight: bold;
    font-size: 1.1em;
}

.input-group label i {
    color: var(--primary-color);
}

.input-group input,
.input-group select,
.input-group textarea {
    width: 100%;
    padding: 15px;
    border: 2px solid var(--border-color);
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.05);
    color: var(--text-light);
    font-size: 1.1em;
    transition: var(--transition);
}

.input-group input:focus,
.input-group select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 20px rgba(74, 144, 226, 0.3);
    background: rgba(255, 255, 255, 0.1);
}

.btn {
    padding: 15px 30px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1.1em;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.three-d-button {
    background: linear-gradient(135deg, var(--primary-color), #3a7bd5);
    color: white;
    box-shadow: 0 10px 20px rgba(74, 144, 226, 0.3);
}

.three-d-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 30px rgba(74, 144, 226, 0.4);
}

.three-d-button:active {
    transform: translateY(-1px);
}

.submit-btn {
    width: 100%;
    margin-top: 20px;
    background: linear-gradient(135deg, var(--success-color), #218838);
}

.search-btn {
    width: 100%;
    margin-top: 20px;
    background: linear-gradient(135deg, var(--accent-color), #e69500);
}

/* ====== TEACHER RING ====== */
.teacher-ring-section {
    padding: 60px 20px;
    background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 100%);
    text-align: center;
    margin: 40px 0;
    position: relative;
    overflow: hidden;
}

.teacher-ring-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(90deg, 
        transparent, 
        var(--primary-color), 
        var(--secondary-color), 
        var(--accent-color), 
        transparent
    );
}

.section-title {
    color: var(--text-light);
    font-size: 2.5em;
    margin-bottom: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
}

.section-title i {
    color: var(--secondary-color);
}

.ring-container {
    width: 100%;
    overflow: hidden;
    position: relative;
    padding: 20px 0;
}

.ring-track {
    display: flex;
    width: max-content;
    gap: 50px;
    animation: scroll-left 30s linear infinite;
    padding: 20px;
}

.ring-track:hover {
    animation-play-state: paused;
}

.teacher-card {
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    color: white;
    transition: var(--transition);
}

.teacher-card:hover {
    transform: scale(1.1);
}

.ring-wrapper {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    padding: 8px;
    background: linear-gradient(45deg, #ff00ea, #00d4ff, #ffcc00, #00ff6a);
    background-size: 300% 300%;
    animation: magic-ring 4s linear infinite, rotateRing 20s linear infinite;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.ring-wrapper img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    background: var(--dark-bg);
    border: 4px solid rgba(255,255,255,0.1);
}

.teacher-card p {
    font-size: 1.2em;
    font-weight: bold;
    color: var(--text-light);
    text-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

/* ====== FOOTER ====== */
.main-footer {
    background: linear-gradient(135deg, #0f0f1f 0%, #1a1a2e 100%);
    padding: 40px 20px;
    text-align: center;
    border-top: 3px solid var(--primary-color);
    margin-top: auto;
}

.footer-content {
    max-width: 1200px;
    margin: 0 auto;
}

.footer-info {
    display: flex;
    justify-content: center;
    gap: 40px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.footer-info p {
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--text-color);
    font-size: 1.1em;
}

.footer-info i {
    color: var(--secondary-color);
    font-size: 1.2em;
}

.social-links {
    display: flex;
    justify-content: center;
    gap: 25px;
    margin: 30px 0;
}

.social-links a {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--light-bg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-light);
    font-size: 1.5em;
    transition: var(--transition);
    text-decoration: none;
}

.social-links a:hover {
    transform: translateY(-5px) scale(1.1);
    background: var(--primary-color);
}

#footer-facebook:hover { background: #1877f2; }
#footer-youtube:hover { background: #ff0000; }
#footer-instagram:hover { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); }
#footer-twitter:hover { background: #1da1f2; }

.footer-help {
    color: var(--secondary-color);
    font-size: 1.1em;
    margin: 20px 0;
    font-style: italic;
}

.copyright {
    color: #888;
    font-size: 0.9em;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid var(--border-color);
}

/* ====== ALERTS ====== */
.alert {
    position: fixed;
    top: 30px;
    right: 30px;
    background: linear-gradient(135deg, var(--warning-color), #e0a800);
    color: #000;
    padding: 20px 25px;
    border-radius: 15px;
    font-weight: bold;
    display: none;
    z-index: 9999;
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
    animation: slideAlert 0.5s ease;
    max-width: 400px;
    border-left: 5px solid #ff9800;
}

.alert.show {
    display: block;
}

.error-message {
    color: var(--danger-color);
    text-align: center;
    margin-top: 15px;
    padding: 10px;
    background: rgba(220, 53, 69, 0.1);
    border-radius: 8px;
    border-left: 4px solid var(--danger-color);
}

/* ====== BHARTI FLOAT BUTTON ====== */
.bharti-float-container {
    position: fixed !important;
    right: 30px;
    bottom: 40px;
    z-index: 2147483647;
    pointer-events: auto;
    animation: bhartiFloat 3.5s ease-in-out infinite;
    will-change: transform;
}

.tooltip-text {
    position: absolute;
    top: -45px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 8px 15px;
    border-radius: 10px;
    font-size: 0.9em;
    white-space: nowrap;
    opacity: 0;
    transition: var(--transition);
    pointer-events: none;
}

.bharti-float-container:hover .tooltip-text {
    opacity: 1;
    transform: translateX(-50%) translateY(-5px);
}

.bharti-float-btn {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #7ffcff, #00bcd4, #0052d4);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 0 30px rgba(0,255,255,0.8);
    text-decoration: none;
    position: relative;
    overflow: hidden;
    transition: var(--transition);
}

.bharti-float-btn i {
    font-size: 2em;
    color: white;
    z-index: 2;
}

.bharti-float-btn::before,
.bharti-float-btn::after {
    content: '';
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    border: 3px solid rgba(0,255,255,0.4);
    animation: softWave 3s infinite;
}

.bharti-float-btn::after {
    animation-delay: 1.5s;
}

.bharti-float-btn:hover {
    transform: scale(1.15);
    box-shadow: 0 0 50px rgba(0,255,255,1);
}

.bharti-float-btn:hover i {
    animation: bounce 0.6s ease;
}

/* ====== ANIMATIONS ====== */
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes waterWave {
    0% { background-position: 0% 50%; }
    100% { background-position: 200% 50%; }
}

@keyframes shineLine {
    0% { left: -60%; }
    100% { left: 120%; }
}

@keyframes flipCoin {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(360deg); }
}

@keyframes logoGlow {
    0%, 100% { filter: brightness(1) drop-shadow(0 0 5px rgba(74, 144, 226, 0.5)); }
    50% { filter: brightness(1.2) drop-shadow(0 0 15px rgba(74, 144, 226, 0.8)); }
}

@keyframes scroll-left {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
}

@keyframes magic-ring {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes rotateRing {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes bhartiFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
}

@keyframes softWave {
    0% { transform: scale(1); opacity: 0.6; }
    100% { transform: scale(2.2); opacity: 0; }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

@keyframes slideAlert {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
    60% { transform: translateY(-5px); }
}

/* ====== RESPONSIVE DESIGN ====== */
@media (max-width: 1200px) {
    .header-content {
        padding: 0 20px;
    }
    
    .vip-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
}

@media (max-width: 992px) {
    #header-title {
        font-size: 2.2em;
    }
    
    .slider-container {
        height: 350px;
    }
    
    .teacher-card .ring-wrapper {
        width: 130px;
        height: 130px;
    }
}

@media (max-width: 768px) {
    .header-content {
        flex-direction: column;
        gap: 20px;
    }
    
    .header-right {
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .result-button {
        padding: 10px 20px;
        font-size: 1em;
    }
    
    .vip-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }
    
    .slider-container {
        height: 300px;
    }
    
    .footer-info {
        flex-direction: column;
        gap: 15px;
    }
    
    .modal-content {
        width: 95%;
        padding: 20px;
    }
}

@media (max-width: 576px) {
    .vip-grid {
        grid-template-columns: 1fr;
    }
    
    .slider-container {
        height: 250px;
    }
    
    .section-title {
        font-size: 2em;
    }
    
    .bharti-float-btn {
        width: 60px;
        height: 60px;
    }
    
    .bharti-float-btn i {
        font-size: 1.5em;
    }
    
    .coin-container {
        width: 60px;
        height: 60px;
    }
}

/* ====== PRINT STYLES ====== */
@media print {
    .bharti-float-container,
    .header-right,
    .slider-btn,
    .vip-section,
    .teacher-ring-section,
    .social-links,
    .modal {
        display: none !important;
    }
    
    body {
        background: white !important;
        color: black !important;
    }
    
    .student-result-display {
        border: none !important;
        box-shadow: none !important;
    }
}

/* ====== DARK MODE SUPPORT ====== */
@media (prefers-color-scheme: dark) {
    .vip-section {
        background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1f 100%);
    }
    
    .vip-grid-item {
        background: var(--card-bg);
        color: var(--text-light);
    }
    
    .vip-grid-item span {
        color: var(--text-light);
    }
}

/* ====== ACCESSIBILITY ====== */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ====== FOCUS STATES ====== */
button:focus,
input:focus,
select:focus,
textarea:focus,
a:focus {
    outline: 3px solid var(--primary-color);
    outline-offset: 3px;
}

/* ====== SCROLLBAR ====== */
::-webkit-scrollbar {
    width: 10px;
}

::-webkit-scrollbar-track {
    background: var(--dark-bg);
}

::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--secondary-color);
}
[file content end]

[file name]: login.js
[file content begin]
document.addEventListener('DOMContentLoaded', async () => {
    // --- DOM Elements ---
    const regPhotoInput = document.getElementById('regPhoto');
    const loader = document.getElementById('loader');
    const headerLogo = document.getElementById('header-logo');
    const headerTitle = document.getElementById('header-title');
    const headerSubtitle = document.getElementById('header-subtitle');
    const footerContact = document.getElementById('footer-contact');
    const footerCall = document.getElementById('footer-call');
    const footerGmail = document.getElementById('footer-gmail');
    const footerFacebook = document.getElementById('footer-facebook');
    const footerYoutube = document.getElementById('footer-youtube');
    const footerInstagram = document.getElementById('footer-instagram');
    const footerTwitter = document.getElementById('footer-twitter');
    const footerHelp = document.getElementById('footer-help');

    // Login Elements
    const loginModal = document.getElementById('loginModal');
    const loginBtn = document.getElementById('loginBtn');
    const closeLogin = document.getElementById('closeLogin');
    const loginForm = document.getElementById('loginForm');
    const loginMessage = document.getElementById('loginMessage');

    const studentResultBtn = document.getElementById('studentResultBtn');
    const resultModal = document.getElementById('resultModal');
    const searchStudentBtn = document.getElementById('searchStudentBtn');
    const searchStudentIdInput = document.getElementById('searchStudentId');
    const searchMessage = document.getElementById('searchMessage');
    const studentResultDisplay = document.getElementById('studentResultDisplay');
    const detailedResultContent = document.getElementById('detailedResultContent');
    const downloadPdfBtn = document.getElementById('downloadPdfBtn');
    const downloadJpgBtn = document.getElementById('downloadJpgBtn');

    // Registration Elements
    const regModal = document.getElementById('regModal');
    const regBtn = document.getElementById('studentRegBtn');
    const closeReg = document.getElementById('closeReg');
    const studentRegForm = document.getElementById('studentRegForm');

    // --- Show loader initially ---
    loader.style.display = 'flex';

    // --- 1. Load System Settings ---
    async function loadSystemSettings() {
        try {
            const response = await fetch('/api/get-settings');
            const settings = await response.json();
            
            if (settings) {
                // Set logo and text
                if (settings.logo) {
                    headerLogo.src = settings.logo;
                    headerLogo.style.display = 'block';
                    headerLogo.onerror = () => {
                        headerLogo.src = 'https://via.placeholder.com/80x80/4a90e2/ffffff?text=BBCC';
                    };
                }
                
                headerTitle.textContent = settings.title || 'BBCC Portal';
                headerSubtitle.textContent = settings.sub_title || 'Education for All';
                
                // Set footer info
                footerContact.textContent = settings.contact || 'Chakdah Chowk, Madhubani';
                footerCall.textContent = settings.call_no || '+91 9971095964';
                footerGmail.textContent = settings.gmail || 'balbharticoaching.center@gmail.com';
                footerHelp.textContent = settings.help || 'For any query, feel free to contact us';
                
                // Set social links
                if (settings.facebook) footerFacebook.href = settings.facebook;
                if (settings.youtube_link) footerYoutube.href = settings.youtube_link;
                if (settings.instagram) footerInstagram.href = settings.instagram;
                if (settings.twitter) footerTwitter.href = settings.twitter;
                
                // Hide social links if not available
                if (!settings.facebook) footerFacebook.style.display = 'none';
                if (!settings.youtube_link) footerYoutube.style.display = 'none';
                if (!settings.instagram) footerInstagram.style.display = 'none';
                if (!settings.twitter) footerTwitter.style.display = 'none';
            }
        } catch (error) {
            console.error('Settings load error:', error);
            showSmoothAlert('‚ö†Ô∏è Settings loading failed. Using default values.');
            
            // Set default values
            headerTitle.textContent = 'BBCC Portal';
            headerSubtitle.textContent = 'Bal Bharti Coaching Center';
            footerContact.textContent = 'Chakdah Chowk, Madhubani';
            footerCall.textContent = '+91 9971095964';
            footerGmail.textContent = 'balbharticoaching.center@gmail.com';
        } finally {
            setTimeout(() => {
                loader.style.display = 'none';
            }, 500);
        }
    }

    // --- 2. Login Logic ---
    if (loginBtn) {
        loginBtn.onclick = () => {
            loginModal.style.display = 'flex';
            document.getElementById('userId').focus();
        };
    }

    if (closeLogin) {
        closeLogin.onclick = () => {
            loginModal.style.display = 'none';
            loginForm.reset();
            loginMessage.textContent = '';
        };
    }

    loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const submitBtn = loginForm.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';
        submitBtn.disabled = true;
        
        const userId = document.getElementById('userId').value.trim();
        const password = document.getElementById('password').value;
        let loginType = '';

        try {
            // === ADMIN CHECK ===
            const adminRes = await fetch('/api/get-admin-profile');
            if (adminRes.ok) {
                const admin = await adminRes.json();
                if (admin && admin.admin_userid === userId && admin.admin_pass === password) {
                    loginType = 'admin';
                }
            }

            // === TEACHER / STUDENT CHECK ===
            if (!loginType) {
                const [tRes, sRes] = await Promise.all([
                    fetch('/api/get-teachers'),
                    fetch('/api/get-students')
                ]);

                const teachers = await tRes.json();
                const students = await sRes.json();

                // Teacher check
                const teacher = teachers.find(t => t.teacher_id === userId && t.pass === password);
                if (teacher) {
                    loginType = 'teacher';
                } else {
                    // Student check
                    const student = students.find(
                        s => s.student_id === userId && s.pass === password
                    );

                    if (student) {
                        // üî¥ APPROVAL / FEES CHECK
                        const notApproved = !student.fees || student.fees === "0";

                        if (notApproved) {
                            showSmoothAlert(
                                "‚ö†Ô∏è ‡§Ü‡§™ ‡§Ö‡§≠‡•Ä ‡§Ö‡§™‡•ç‡§∞‡•Ç‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§è ‡§π‡•à‡§Ç‡•§\n‡§´‡•Ä‡§∏ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§π‡•à‡•§"
                            );
                            localStorage.removeItem("studentId");
                            
                            setTimeout(() => {
                                loginModal.style.display = 'none';
                            }, 3000);
                            
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                            return;
                        }

                        // ‚úÖ APPROVED STUDENT
                        loginType = 'student';
                        localStorage.setItem("studentId", student.student_id);
                    }
                }
            }

            // === REDIRECTION ===
            if (loginType === 'admin') {
                localStorage.setItem("isAdminLoggedIn", "true");
                showSmoothAlert("‚úÖ Admin login successful! Redirecting...");
                setTimeout(() => {
                    window.location.replace('/admin');
                }, 1000);
            } else if (loginType === 'teacher') {
                showSmoothAlert("‚úÖ Teacher login successful! Redirecting...");
                setTimeout(() => {
                    window.location.replace('/teacher');
                }, 1000);
            } else if (loginType === 'student') {
                showSmoothAlert("‚úÖ Student login successful! Redirecting...");
                setTimeout(() => {
                    window.location.replace('/student.html');
                }, 1000);
            } else {
                loginMessage.textContent = "‚ùå ‡§ó‡§≤‡§§ User ID ‡§Ø‡§æ Password";
                document.getElementById('password').value = '';
                document.getElementById('userId').focus();
            }

        } catch (err) {
            console.error('Login error:', err);
            loginMessage.textContent = "‚ö†Ô∏è Server Error. Please try again.";
            showSmoothAlert("‚ö†Ô∏è Connection error. Please check your internet.");
        } finally {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        }
    });

    // --- 3. Result Modal & Search Logic ---
    if (studentResultBtn) {
        studentResultBtn.onclick = () => {
            resultModal.style.display = 'flex';
            searchStudentIdInput.focus();
        };
    }
    
    // Close buttons for all modals
    document.querySelectorAll('.close-button').forEach(btn => {
        if (!btn.id) { // Skip the ones with specific IDs
            btn.onclick = (e) => {
                e.target.closest('.modal').style.display = 'none';
            };
        }
    });

    // Smart Search Logic
    searchStudentBtn.onclick = async () => {
        const nameOrId = searchStudentIdInput.value.trim();
        const mobileNum = document.getElementById('searchMobile').value.trim();
        
        if (!nameOrId) {
            searchMessage.textContent = "‚ùå ID ya Name bharna zaroori hai!";
            searchMessage.style.color = "var(--danger-color)";
            searchStudentIdInput.focus();
            return;
        }
        
        const originalText = searchStudentBtn.innerHTML;
        searchStudentBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Searching...';
        searchStudentBtn.disabled = true;
        searchMessage.textContent = "üîç Searching...";
        searchMessage.style.color = "var(--warning-color)";
        
        try {
            const res = await fetch('/api/search-student-result', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    searchTerm: nameOrId,
                    mobileSearch: mobileNum
                })
            });
            
            if (!res.ok) throw new Error('Network response was not ok');
            
            const data = await res.json();

            if (data.success) {
                const s = data.student;
                searchMessage.textContent = "‚úÖ Result found!";
                searchMessage.style.color = "var(--success-color)";
                studentResultDisplay.style.display = 'block';

                // Fill Data
                document.getElementById('result-student-name').textContent = s.student_name || 'N/A';
                document.getElementById('result-student-id').textContent = s.student_id || 'N/A';
                document.getElementById('result-parent-name').textContent = s.parent_name || 'N/A';
                document.getElementById('result-student-class').textContent = s.student_class || 'N/A';
                document.getElementById('result-exam-date').textContent = s.exam_date || 'N/A';
                document.getElementById('result-exam-subject').textContent = s.exam_subject || "General";
                document.getElementById('result-total-marks').textContent = s.total_marks || '0';
                document.getElementById('result-obtained-marks').textContent = s.obtained_marks || '0';

                const obtained = parseFloat(s.obtained_marks) || 0;
                const total = parseFloat(s.total_marks) || 0;
                const percentage = total > 0 ? ((obtained / total) * 100).toFixed(2) : "0";
                document.getElementById('result-percentage').textContent = percentage;

                const photoUrl = s.photo || 'https://via.placeholder.com/120x140/4a90e2/ffffff?text=Student';
                document.getElementById('result-student-photo').src = photoUrl;
                
                // Setup download events
                setupDownloadEvents(s.student_id || 'unknown');
                
                // Scroll to result
                studentResultDisplay.scrollIntoView({ behavior: 'smooth' });
            } else {
                searchMessage.textContent = data.message || "‚ùå Student not found!";
                searchMessage.style.color = "var(--danger-color)";
                studentResultDisplay.style.display = 'none';
            }
        } catch (err) {
            console.error('Search error:', err);
            searchMessage.textContent = "‚ùå Connection Error! Please try again.";
            searchMessage.style.color = "var(--danger-color)";
            studentResultDisplay.style.display = 'none';
        } finally {
            searchStudentBtn.innerHTML = originalText;
            searchStudentBtn.disabled = false;
        }
    };

    function setupDownloadEvents(stuId) {
        const element = studentResultDisplay;
        const btns = element.querySelector('.download-buttons');

        if (downloadPdfBtn) {
            downloadPdfBtn.onclick = async () => {
                const originalText = downloadPdfBtn.innerHTML;
                downloadPdfBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
                downloadPdfBtn.disabled = true;
                btns.style.display = 'none';
                
                try {
                    await html2canvasPromise(element);
                    
                    const { jsPDF } = window.jspdf;
                    html2canvas(element, { 
                        scale: 2, 
                        useCORS: true,
                        backgroundColor: '#ffffff'
                    }).then(canvas => {
                        const pdf = new jsPDF('p', 'mm', 'a4');
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
                        
                        pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 10, pdfWidth, pdfHeight);
                        pdf.save(`BBCC_Result_${stuId}.pdf`);
                        
                        showSmoothAlert("‚úÖ PDF downloaded successfully!");
                    });
                } catch (err) {
                    console.error('PDF generation error:', err);
                    showSmoothAlert("‚ùå PDF download failed!");
                } finally {
                    btns.style.display = 'flex';
                    downloadPdfBtn.innerHTML = originalText;
                    downloadPdfBtn.disabled = false;
                }
            };
        }

        if (downloadJpgBtn) {
            downloadJpgBtn.onclick = async () => {
                const originalText = downloadJpgBtn.innerHTML;
                downloadJpgBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
                downloadJpgBtn.disabled = true;
                btns.style.display = 'none';
                
                try {
                    await html2canvasPromise(element);
                    
                    html2canvas(element, { 
                        scale: 2,
                        backgroundColor: '#ffffff'
                    }).then(canvas => {
                        const link = document.createElement('a');
                        link.download = `BBCC_Result_${stuId}.jpg`;
                        link.href = canvas.toDataURL("image/jpeg", 0.9);
                        link.click();
                        
                        showSmoothAlert("‚úÖ Image downloaded successfully!");
                    });
                } catch (err) {
                    console.error('Image generation error:', err);
                    showSmoothAlert("‚ùå Image download failed!");
                } finally {
                    btns.style.display = 'flex';
                    downloadJpgBtn.innerHTML = originalText;
                    downloadJpgBtn.disabled = false;
                }
            };
        }
    }

    // Promise wrapper for html2canvas
    function html2canvasPromise(element) {
        return new Promise((resolve, reject) => {
            try {
                html2canvas(element, { 
                    scale: 2,
                    useCORS: true,
                    backgroundColor: '#ffffff'
                }).then(resolve).catch(reject);
            } catch (err) {
                reject(err);
            }
        });
    }

    // --- 4. Registration Logic ---
    if (regBtn) {
        regBtn.onclick = () => {
            regModal.style.display = "block";
            document.getElementById('regName').focus();
            
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('regDate').value = today;
        };
    }
    
    if (closeReg) {
        closeReg.onclick = () => {
            regModal.style.display = "none";
            studentRegForm.reset();
            document.getElementById('photoPreviewContainer').style.display = 'none';
        };
    }

    let compressedPhotoBase64 = "";

    // Image compression function
    async function handleImageCompression(file) {
        return new Promise((resolve, reject) => {
            if (!file.type.match('image.*')) {
                showSmoothAlert("‚ùå Please select an image file");
                reject("Not an image file");
                return;
            }
            
            if (file.size > 5 * 1024 * 1024) { // 5MB limit
                showSmoothAlert("‚ùå Image size should be less than 5MB");
                reject("File too large");
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const maxDimension = 300;
                    let width = img.width;
                    let height = img.height;
                    
                    if (width > height) {
                        if (width > maxDimension) {
                            height = (height * maxDimension) / width;
                            width = maxDimension;
                        }
                    } else {
                        if (height > maxDimension) {
                            width = (width * maxDimension) / height;
                            height = maxDimension;
                        }
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    compressedPhotoBase64 = canvas.toDataURL('image/jpeg', 0.7);
                    
                    // Show preview
                    document.getElementById('photoPreview').src = compressedPhotoBase64;
                    document.getElementById('photoPreviewContainer').style.display = 'block';
                    
                    const size = Math.round((compressedPhotoBase64.length * 3/4) / 1024);
                    document.getElementById('photoSizeLabel').innerText = `Size: ~${size} KB`;
                    document.getElementById('photoSizeLabel').style.color = size > 100 ? 'var(--danger-color)' : 'var(--success-color)';
                    
                    resolve();
                };
                img.onerror = () => {
                    showSmoothAlert("‚ùå Error loading image");
                    reject("Image load error");
                };
                img.src = e.target.result;
            };
            reader.onerror = () => {
                showSmoothAlert("‚ùå Error reading file");
                reject("File read error");
            };
            reader.readAsDataURL(file);
        });
    }

    // Photo input change event
    if (regPhotoInput) {
        regPhotoInput.onchange = async (e) => {
            if (e.target.files && e.target.files[0]) {
                try {
                    await handleImageCompression(e.target.files[0]);
                } catch (err) {
                    console.error("Image compression error:", err);
                }
            }
        };
    }

    // Registration form submission
    studentRegForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const submitBtn = studentRegForm.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
        submitBtn.disabled = true;

        // Generate Unique ID
        const date = new Date();
        const datePart = `${date.getFullYear().toString().slice(2)}${(date.getMonth() + 1).toString().padStart(2, '0')}`;
        const randomPart = Math.floor(1000 + Math.random() * 9000);
        const generatedId = `STU${datePart}${randomPart}`;

        const selectedClass = document.getElementById('regClassSelect').value;
        if (!selectedClass) {
            showSmoothAlert("‚ùå Please select a class");
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            return;
        }

        // Validate mobile numbers
        const mobile = document.getElementById('regMobile').value.trim();
        const parentMobile = document.getElementById('regParentMobile').value.trim();
        
        if (mobile && !/^\d{10}$/.test(mobile)) {
            showSmoothAlert("‚ùå Please enter a valid 10-digit mobile number");
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            return;
        }

        const formData = {
            student_name: document.getElementById('regName').value.trim(),
            parent_name: document.getElementById('regParent').value.trim(),
            mobile: mobile,
            parent_mobile: parentMobile,
            student_class: selectedClass,
            joining_date: document.getElementById('regDate').value,
            student_id: generatedId,
            pass: document.getElementById('regPass').value || "123456",
            photo: compressedPhotoBase64 || "",
            fees: "0"
        };

        try {
            const response = await fetch('/api/student-reg', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData)
            });
            
            const result = await response.json();
            
            if (result.success) {
                showSmoothAlert(`‚úÖ Registration successful! Student ID: ${result.student_id}`);
                regModal.style.display = "none";
                studentRegForm.reset();
                compressedPhotoBase64 = "";
                document.getElementById('photoPreviewContainer').style.display = 'none';
            } else {
                showSmoothAlert(`‚ùå Error: ${result.error || 'Registration failed'}`);
            }
        } catch (err) {
            console.error('Registration error:', err);
            showSmoothAlert("‚ùå Server connection failed! Please try again.");
        } finally {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        }
    });

    // Close modals on outside click
    window.onclick = (event) => {
        if (event.target == regModal) regModal.style.display = "none";
        if (event.target == resultModal) resultModal.style.display = "none";
        if (event.target == loginModal) loginModal.style.display = "none";
        
        const classDetailModal = document.getElementById('classDetailModal');
        if (classDetailModal && event.target == classDetailModal) {
            classDetailModal.style.display = "none";
        }
    };

    // --- 5. Slider Functions ---
    let currentSlide = 0;
    let totalSlides = 0;
    let sliderInterval;

    async function fetchSliderPhotos() {
        try {
            const response = await fetch('/api/get-sliders');
            const photos = await response.json();
            const wrapper = document.getElementById('dynamic-slider');
            const indicators = document.getElementById('sliderIndicators');
            
            if (photos && photos.length > 0) {
                totalSlides = photos.length;
                
                // Create slides
                wrapper.innerHTML = photos.map(p => 
                    `<img src="${p.photo}" alt="Slider" loading="lazy" onerror="this.src='https://via.placeholder.com/1200x400/1a1a2e/4a90e2?text=BBCC+Slide'">`
                ).join('');
                
                // Create indicators
                indicators.innerHTML = Array.from({length: totalSlides}, (_, i) => 
                    `<span class="${i === 0 ? 'active' : ''}" onclick="goToSlide(${i})"></span>`
                ).join('');
                
                // Start auto-slide
                clearInterval(sliderInterval);
                sliderInterval = setInterval(() => moveSlider(1), 5000);
            } else {
                wrapper.innerHTML = `
                    <div class="slide-placeholder">
                        <i class="fas fa-images"></i>
                        <p>Welcome to BBCC Portal</p>
                    </div>
                `;
                indicators.innerHTML = '';
            }
        } catch (err) {
            console.error("Slider Load Error:", err);
            const wrapper = document.getElementById('dynamic-slider');
            wrapper.innerHTML = `
                <div class="slide-placeholder">
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>Slider loading failed</p>
                </div>
            `;
        }
    }

    function moveSlider(direction) {
        if (totalSlides === 0) return;
        
        currentSlide += direction;
        if (currentSlide >= totalSlides) currentSlide = 0;
        if (currentSlide < 0) currentSlide = totalSlides - 1;
        
        updateSlider();
    }

    function goToSlide(index) {
        currentSlide = index;
        updateSlider();
    }

    function updateSlider() {
        const wrapper = document.getElementById('dynamic-slider');
        const indicators = document.querySelectorAll('#sliderIndicators span');
        
        if (wrapper) {
            wrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
        }
        
        indicators.forEach((indicator, index) => {
            indicator.classList.toggle('active', index === currentSlide);
        });
        
        // Reset auto-slide timer
        clearInterval(sliderInterval);
        sliderInterval = setInterval(() => moveSlider(1), 5000);
    }

    // --- 6. Teacher Ring ---
    async function loadTeacherRing() {
        try {
            const response = await fetch('/api/get-teachers');
            const teachers = await response.json();
            const ringContainer = document.getElementById('teacher-ring');
            
            if (teachers && teachers.length > 0) {
                // Create teacher cards
                const teacherCards = teachers.map(t => `
                    <div class="teacher-card" title="${t.teacher_name || 'Teacher'}">
                        <div class="ring-wrapper">
                            <img src="${t.photo || 'https://via.placeholder.com/150/1a1a2e/4a90e2?text=Teacher'}" 
                                 alt="${t.teacher_name || 'Teacher'}"
                                 loading="lazy"
                                 onerror="this.src='https://via.placeholder.com/150/1a1a2e/4a90e2?text=Teacher'">
                        </div>
                        <p>${t.teacher_name || 'Teacher'}</p>
                        ${t.subject ? `<small style="color: var(--secondary-color);">${t.subject}</small>` : ''}
                    </div>
                `).join('');
                
                // Duplicate for seamless loop
                ringContainer.innerHTML = teacherCards + teacherCards;
            } else {
                ringContainer.innerHTML = `
                    <div style="text-align: center; color: var(--text-color); padding: 50px;">
                        <i class="fas fa-users fa-3x" style="margin-bottom: 20px;"></i>
                        <p>Teacher information coming soon</p>
                    </div>
                `;
            }
        } catch (err) {
            console.error("Teacher Ring Error:", err);
            const ringContainer = document.getElementById('teacher-ring');
            ringContainer.innerHTML = `
                <div style="text-align: center; color: var(--text-color); padding: 50px;">
                    <i class="fas fa-exclamation-triangle fa-3x" style="margin-bottom: 20px;"></i>
                    <p>Failed to load teachers</p>
                </div>
            `;
        }
    }

    // --- 7. Alert Function ---
    function showSmoothAlert(msg) {
        const box = document.getElementById("alertBox");
        if (!box) return;
        
        box.innerText = msg;
        box.classList.add("show");
        
        // Different colors for different message types
        if (msg.includes("‚úÖ") || msg.includes("success")) {
            box.style.background = "linear-gradient(135deg, var(--success-color), #218838)";
        } else if (msg.includes("‚ö†Ô∏è") || msg.includes("warning")) {
            box.style.background = "linear-gradient(135deg, var(--warning-color), #e0a800)";
        } else if (msg.includes("‚ùå") || msg.includes("error")) {
            box.style.background = "linear-gradient(135deg, var(--danger-color), #c82333)";
        } else {
            box.style.background = "linear-gradient(135deg, var(--primary-color), #3a7bd5)";
        }
        
        setTimeout(() => {
            box.classList.remove("show");
        }, 3000);
    }

    // --- 8. VIP Functions ---
    window.openVip = function(id) {
        const popup = document.getElementById(id);
        if (popup) {
            popup.style.display = "block";
            document.body.style.overflow = "hidden";
        }
    };
    
    window.closeVip = function(id) {
        const popup = document.getElementById(id);
        if (popup) {
            popup.style.display = "none";
            document.body.style.overflow = "auto";
        }
    };
    
    window.showLang = function(pid, lang) {
        // Hide all content for this popup
        document.querySelectorAll(`#${pid} .lang-content`).forEach(e => {
            e.classList.remove("active");
        });
        
        // Remove active class from all buttons
        document.querySelectorAll(`#${pid} .lang-tabs button`).forEach(b => {
            b.classList.remove("active");
        });
        
        // Show selected content
        const content = document.getElementById(`${pid}-${lang}`);
        const button = document.getElementById(`${pid}-btn-${lang}`);
        
        if (content) content.classList.add("active");
        if (button) button.classList.add("active");
    };
    
    // Auto-open admission popup after 3 seconds
    setTimeout(() => {
        openVip('vipAdmission');
    }, 3000);

    // --- 9. Keyboard Shortcuts ---
    document.addEventListener('keydown', (e) => {
        // Escape closes modals
        if (e.key === 'Escape') {
            const modals = document.querySelectorAll('.modal, .vip-popup');
            modals.forEach(modal => {
                if (modal.style.display === 'flex' || modal.style.display === 'block') {
                    modal.style.display = 'none';
                }
            });
            document.body.style.overflow = "auto";
        }
        
        // Ctrl + R for registration
        if (e.ctrlKey && e.key === 'r') {
            e.preventDefault();
            if (regBtn) regBtn.click();
        }
        
        // Ctrl + L for login
        if (e.ctrlKey && e.key === 'l') {
            e.preventDefault();
            if (loginBtn) loginBtn.click();
        }
    });

    // --- 10. Initial Load ---
    await loadSystemSettings();
    await fetchSliderPhotos();
    await loadTeacherRing();
    
    // Show welcome message
    setTimeout(() => {
        showSmoothAlert("üëã Welcome to Bal Bharti Coaching Center Portal!");
    }, 1000);
});
