<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BBCC Admin Dashboard</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script src="https://code.responsivevoice.org/responsivevoice.js"></script>
<link rel="stylesheet" href="admin.css">
</head>

<body onload="initDashboard()">

<header class="magical-header">
  <div class="logo-container">
    <img id="db-logo" class="ring-logo">
  </div>
  <div class="title-container">
    <h1 id="db-title">Loading...</h1>
    <span id="db-subtitle"></span>
  </div>
 
<div class="admin-profile-trigger" onclick="openAdminProfile()" style="cursor:pointer; display:inline-block; margin-right:15px; vertical-align: middle;">
    <img id="header_admin_photo" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" style="width:40px; height:40px; border-radius:50%; border:2px solid #fff; object-fit: cover;">
</div>
  <button onclick="logoutAdmin()" class="logout-btn">
    <i class="fas fa-sign-out-alt"></i> Logout
  </button>
</header>

<!-- üîî Pending New Registration Box -->
<div class="pending-box">
  <h3>üïí Pending New Registration üîî </h3>
  <div id="pendingList"></div>
</div>

  
<div class="dashboard">
  <div class="button-group" data-label="Student Management">
    <button id="openStudentDashboardBtn"
      class="btn-primary"
      style="background:#2ecc71;display:none;">
      üìä Student Dashboard
    </button>
    <button onclick="openClassExamModal()" style="background:#6c5ce7; color:white; padding:10px;">üìä Class Exam Dashboard</button>
  </div>
  <div class="button-group" data-label="Administrative Controls">
    <button onclick="openSystemConfig()" style="background:#e67e22; color:white;">
        <i class="fas fa-cogs"></i> System Settings
    </button>
    
    <button onclick="openSliderManager()" style="background:#6c5ce7; color:white;">
        <i class="fas fa-images"></i> Slider Management
    </button>
    
</div>
  </div>
<h2>üìò Class Management</h2>

<div id="classContainer"></div>
  

  <div id="classModal" class="modal">
    <div class="modal-content">
        <h3 id="modalTitle"></h3>

        <label>Class Banner</label>
        <input type="file" id="bannerInput">

        <label>YouTube Intro</label>
        <input type="text" id="videoInput">

        <label>Notes PDF</label>
        <input type="file" id="pdfInput">

        <button onclick="saveClassDetail()">Save</button>
        <button onclick="closeModal()">Close</button>
    </div>
</div>
<div id="systemConfigModal" class="modal">
    <div class="modal-content" style="max-width:500px">
        <span class="close" onclick="closeModal('systemConfigModal')">&times;</span>
        <h3>‚öôÔ∏è System Configuration</h3>
        <div style="text-align: left; display: grid; gap: 10px;">
            <label>Coaching Title:</label> <input type="text" id="cfg_title">
            <label>Sub-Title:</label> <input type="text" id="cfg_subtitle">
            <label>Contact No:</label> <input type="text" id="cfg_contact">
          <label>WhatsApp/Call No:</label> 
<input type="text" id="cfg_call_no" class="admin-input">
            <label>Gmail:</label> <input type="text" id="cfg_gmail">
            <label>Facebook Link:</label> <input type="text" id="cfg_facebook">
            <label>YouTube Link:</label> <input type="text" id="cfg_youtube">
            <label>Instagram Link:</label> <input type="text" id="cfg_insta">
            <button onclick="saveSystemConfig()" style="background:#2ecc71; color:white; padding:10px;">Update Settings</button>
        </div>
    </div>
</div>

<div id="sliderModal" class="modal">
    <div class="modal-content" style="max-width:600px">
        <span class="close" onclick="closeModal('sliderModal')">&times;</span>
        <h3>üñºÔ∏è Manage Front-Page Sliders</h3>
        
        <div style="border: 2px dashed #ccc; padding: 20px; margin-bottom: 20px;">
            <input type="file" id="slider_file" accept="image/*" onchange="previewAndCropSlider(this)">
            <p style="font-size: 12px; color: #666;">Size: 200x200 (Auto-compressed to 5KB)</p>
            <canvas id="cropCanvas" width="200" height="200" style="border:1px solid #000; display:none; margin: 10px auto;"></canvas>
            <div id="sliderPreviewContainer" style="display:none;">
                <img id="slider_crop_preview" style="width:200px; height:200px; object-fit:cover; border:2px solid #6c5ce7;">
                <br><button onclick="uploadSlider()" style="background:#6c5ce7; color:white; margin-top:10px;">Upload This Photo</button>
            </div>
        </div>

        <div id="existingSliders" style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
            </div>
    </div>
</div>
<!-- ================= STUDENT DASHBOARD ================= -->
<div id="studentDashboardModal" class="modal">
  <div class="modal-content" style="max-width:95%">
    <span class="close">&times;</span>
    <h3>üìä Student Dashboard (Excel View)</h3>

    <div style="display:flex;gap:10px;margin-bottom:10px;">
      <select id="dash_class"></select>
      <select id="dash_year"></select>
      <button onclick="loadDashboardStudents()">Load</button>
      <button onclick="downloadStudentExcel()" style="background:#27ae60;">üì• Download Excel</button>
      <button onclick="deleteLoadedClass()">üóë Delete Loaded Class</button>
    </div>

    <div style="margin:10px;font-weight:bold;">
      Total Students: <span id="dashTotal">0</span>
    </div>

    <div style="overflow:auto;max-height:70vh">
      <table border="1" width="100%">
        <thead>
          <tr>
            <th>Photo</th><th>ID</th><th>Name</th><th>Pass</th>
            <th>Class</th><th>DOJ</th><th>Fees</th>
            <th>Exam</th><th>Total</th><th>Obt</th>
            <th>Div</th><th>Save</th><th>Delete</th>
          </tr>
        </thead>
        <tbody id="dashboardBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- ================= FEES MODAL ================= -->
<div id="feesExcelModal" class="modal">
  <div class="modal-content" style="max-width:90%">
    <span class="close">&times;</span>
    <h3>üìí Student Monthly Fees Tracker</h3>

    <div id="feesStudentInfo"></div>

    <div style="display:flex;gap:10px;margin:10px 0">
      <select id="fees_year"></select>
      <select id="fees_month"></select>
      <button onclick="loadFeesExcel()">Load</button>
      <button onclick="downloadFeesExcel()" style="background:#27ae60;">üì• Download Fees</button>
    </div>

    <table border="1" width="100%">
      <thead>
        <tr>
          <th>Month</th><th>Fees</th><th>Paid</th>
          <th>Due</th><th>Status</th><th>Save</th>
        </tr>
      </thead>
      <tbody id="feesExcelBody"></tbody>
    </table>

    <div style="margin-top:10px;font-weight:bold">
      Total Paid: ‚Çπ<span id="totalPaid">0</span> |
      Total Due: ‚Çπ<span id="totalDue">0</span>
    </div>
  </div>
</div>

<!-- ================= STUDENT EDIT ================= -->
<div id="studentEditModal" class="modal">
  <div class="modal-content" style="max-width:400px">
    <span class="close">&times;</span>
    <h3>‚úèÔ∏è Edit Student</h3>

    <img id="edit_photo_preview" width="80" style="border-radius:50%"><br>
    <input type="file" id="edit_photo_file" accept="image/*"><br><br>

    <input id="edit_id" disabled><br><br>
    <input id="edit_class" placeholder="Class"><br><br>
    <input id="edit_name" placeholder="Student Name"><br><br>
    <input id="edit_parent" placeholder="Parent Name"><br><br>
    <input id="edit_mobile" placeholder="Mobile"><br><br>
    <input id="edit_parent_mobile" placeholder="Parent Mobile"><br><br>

    <button onclick="updateStudentProfile()">‚úÖ Update</button>
  </div>
</div>


<div id="classExamModal" class="modal" style="display:none;">
    <div class="modal-content" style="width: 90%; max-width: 1000px;">
        <span class="close" onclick="this.closest('.modal').style.display='none'">&times;</span>
        <h2>üìù Bulk Exam Management</h2>
        
        <div style="background: #f4f4f4; padding: 15px; border-radius: 8px; margin-bottom: 15px; display: flex; gap: 10px; flex-wrap: wrap; align-items: flex-end;">
            <div>
                <label>Class:</label><br>
                <select id="exam_dash_class" onchange="loadExamStudents()"></select>
            </div>
            <div>
                <label>Year:</label><br>
                <select id="exam_dash_year" onchange="loadExamStudents()"></select>
            </div>
          <div>
    <label>Subject Name:</label><br>
    <select id="bulk_subject" style="padding:8px; width:200px; border-radius:4px; border:1px solid #ccc;">
        <option value="">-- Select Subject --</option>
        
        <optgroup label="Core School Subjects">
            <option value="Hindi">Hindi</option>
            <option value="English">English</option>
            <option value="Maths">Mathematics</option>
            <option value="Science">Science (General)</option>
            <option value="Social Science">Social Science</option>
            <option value="Sanskrit">Sanskrit</option>
            <option value="EVS">Environmental Science (EVS)</option>
            <option value="Urdu">Urdu</option>
            <option value="Drawing/Art">Drawing/Art</option>
            <option value="General Knowledge">General Knowledge (GK)</option>
            <option value="Moral Science">Moral Science</option>
        </optgroup>

        <optgroup label="Science Stream">
            <option value="Physics">Physics</option>
            <option value="Chemistry">Chemistry</option>
            <option value="Biology">Biology</option>
            <option value="Botany">Botany</option>
            <option value="Zoology">Zoology</option>
            <option value="Biotechnology">Biotechnology</option>
        </optgroup>

        <optgroup label="Commerce Stream">
            <option value="Accountancy">Accountancy</option>
            <option value="Business Studies">Business Studies</option>
            <option value="Economics">Economics</option>
            <option value="Statistics">Statistics</option>
        </optgroup>

        <optgroup label="Arts & Humanities">
            <option value="History">History</option>
            <option value="Geography">Geography</option>
            <option value="Political Science">Political Science</option>
            <option value="Civics">Civics</option>
            <option value="Sociology">Sociology</option>
            <option value="Psychology">Psychology</option>
            <option value="Philosophy">Philosophy</option>
            <option value="Home Science">Home Science</option>
        </optgroup>

        <optgroup label="Computers & IT">
            <option value="Computer Science">Computer Science</option>
            <option value="Information Technology">Information Technology (IT)</option>
            <option value="Coding">Coding/Programming</option>
            <option value="Artificial Intelligence">Artificial Intelligence</option>
        </optgroup>

        <optgroup label="Vocational & Others">
            <option value="Physical Education">Physical Education (P.T.)</option>
            <option value="Music">Music</option>
            <option value="Dance">Dance</option>
            <option value="Yoga">Yoga</option>
            <option value="Library Science">Library Science</option>
        </optgroup>

        <optgroup label="Exam Labels">
            <option value="Unit Test">Unit Test</option>
            <option value="Half Yearly">Half Yearly Exam</option>
            <option value="Annual Exam">Annual Exam</option>
            <option value="Weekly Test">Weekly Test</option>
        </optgroup>
    </select>
</div>
            <div>
                <label>Total Marks:</label><br>
                <input type="number" id="bulk_total_marks" placeholder="100">
            </div>
            <div>
                <label>Exam Date:</label><br>
                <input type="date" id="bulk_exam_date">
            </div>
            <button onclick="applyBulkSettings()" style="background:#00b894; color:white;">Apply to All</button>
        </div>

        <table border="1" style="width:100%; border-collapse: collapse; text-align: center;">
            <thead>
                <tr style="background:#dfe6e9;">
                    <th>Photo</th>
                    <th>ID & Name</th>
                    <th>Exam Date</th>
                    <th>Subject</th>
                    <th>Total Marks</th>
                    <th>Obtained Marks</th>
                    <th>Division</th>
                </tr>
            </thead>
            <tbody id="examDashboardBody"></tbody>
        </table>

        <div style="margin-top:20px; display:flex; gap:10px;">
            <button onclick="saveAllResults()" style="background:#0984e3; color:white; padding:10px 20px;">üì¢ Public Result (Save All)</button>
            <button onclick="cancelAllExams()" style="background:#d63031; color:white; padding:10px 20px;">üö´ Cancel Exam (Clear All)</button>
        </div>
    </div>
</div>
<!-- ================= Admin profile modal code  ================= -->
<div id="adminProfileModal" class="modal">
  <div class="modal-content" style="max-width:400px; text-align:center; border-radius: 15px;">
    <span class="close" onclick="closeAdminModal()">&times;</span>
    <h3 style="color:#6c5ce7;"><i class="fas fa-user-shield"></i> Admin Profile</h3>
    <hr>
    
    <div class="profile-pic-container" style="position:relative; display:inline-block;">
        <img id="admin_preview_img" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" style="width:110px; height:110px; border-radius:50%; object-fit:cover; border:3px solid #6c5ce7; padding:3px;">
        <label for="admin_photo_input" style="position:absolute; bottom:5px; right:5px; background:#6c5ce7; color:white; border-radius:50%; width:30px; height:30px; display:flex; align-items:center; justify-content:center; cursor:pointer; border:2px solid white;">
            <i class="fas fa-camera" style="font-size:14px;"></i>
        </label>
        <input type="file" id="admin_photo_input" accept="image/*" style="display:none;" onchange="handleAdminPhoto(this)">
    </div>
    <p style="font-size:10px; color:gray;">Auto-compressed to 5KB limit</p>

    <div style="margin-top:15px; text-align:left;">
        <label style="font-weight:bold; font-size:13px;">Admin UserID:</label>
        <input type="text" id="admin_userid" placeholder="User ID" style="width:100%; padding:8px; margin-bottom:10px; border:1px solid #ccc; border-radius:5px;">
        
        <label style="font-weight:bold; font-size:13px;">Display Name:</label>
        <input type="text" id="admin_name" placeholder="Full Name" style="width:100%; padding:8px; margin-bottom:10px; border:1px solid #ccc; border-radius:5px;">
        
        <label style="font-weight:bold; font-size:13px;">Mobile No:</label>
        <input type="text" id="admin_mobile" placeholder="Mobile" style="width:100%; padding:8px; margin-bottom:10px; border:1px solid #ccc; border-radius:5px;">
        
        <label style="font-weight:bold; font-size:13px;">New Password:</label>
        <input type="password" id="admin_pass" placeholder="Password" style="width:100%; padding:8px; margin-bottom:15px; border:1px solid #ccc; border-radius:5px;">
        
        <button onclick="updateAdminProfile()" style="background:#6c5ce7; color:white; width:100%; padding:12px; border:none; border-radius:5px; font-weight:bold; cursor:pointer;">
            <i class="fas fa-save"></i> Save Database Changes
        </button>
    </div>
  </div>
</div>
  
<footer class="magical-footer">
  <div class="social-icons">
    <a id="foot-whatsapp"><i class="fab fa-whatsapp"></i></a>
    <a id="foot-facebook"><i class="fab fa-facebook"></i></a>
    <a id="foot-gmail"><i class="fas fa-envelope"></i></a>
    <a id="foot-call"><i class="fas fa-phone-alt"></i></a>
  </div>
  <p id="foot-help"></p>
</footer>

<script src="adminscript.js"></script>
</body>
</html>
