<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BBCC Admin Dashboard</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script src="https://code.responsivevoice.org/responsivevoice.js"></script>
<link rel="stylesheet" href="admin.css">
</head>

<body onload="initDashboard()">

<header class="magical-header">
  <div class="logo-container">
    <img id="db-logo" class="ring-logo">
  </div>
  <div class="title-container">
    <h1 id="db-title">Loading...</h1>
    <span id="db-subtitle"></span>
  </div>
  <button onclick="logoutAdmin()" class="logout-btn">
    <i class="fas fa-sign-out-alt"></i> Logout
  </button>
</header>

<div class="dashboard">
  <div class="button-group" data-label="Student Management">
    <button id="openStudentDashboardBtn"
      class="btn-primary"
      style="background:#2ecc71;display:none;">
      üìä Student Dashboard
    </button>
    <button onclick="openClassExamModal()" style="background:#6c5ce7; color:white; padding:10px;">üìä Class Exam Dashboard</button>
  </div>
</div>

<!-- ================= STUDENT DASHBOARD ================= -->
<div id="studentDashboardModal" class="modal">
  <div class="modal-content" style="max-width:95%">
    <span class="close">&times;</span>
    <h3>üìä Student Dashboard (Excel View)</h3>

    <div style="display:flex;gap:10px;margin-bottom:10px;">
      <select id="dash_class"></select>
      <select id="dash_year"></select>
      <button onclick="loadDashboardStudents()">Load</button>
      <button onclick="downloadStudentExcel()" style="background:#27ae60;">üì• Download Excel</button>
      <button onclick="deleteLoadedClass()">üóë Delete Loaded Class</button>
    </div>

    <div style="margin:10px;font-weight:bold;">
      Total Students: <span id="dashTotal">0</span>
    </div>

    <div style="overflow:auto;max-height:70vh">
      <table border="1" width="100%">
        <thead>
          <tr>
            <th>Photo</th><th>ID</th><th>Name</th><th>Pass</th>
            <th>Class</th><th>DOJ</th><th>Fees</th>
            <th>Exam</th><th>Total</th><th>Obt</th>
            <th>Div</th><th>Save</th><th>Delete</th>
          </tr>
        </thead>
        <tbody id="dashboardBody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- ================= FEES MODAL ================= -->
<div id="feesExcelModal" class="modal">
  <div class="modal-content" style="max-width:90%">
    <span class="close">&times;</span>
    <h3>üìí Student Monthly Fees Tracker</h3>

    <div id="feesStudentInfo"></div>

    <div style="display:flex;gap:10px;margin:10px 0">
      <select id="fees_year"></select>
      <select id="fees_month"></select>
      <button onclick="loadFeesExcel()">Load</button>
      <button onclick="downloadFeesExcel()" style="background:#27ae60;">üì• Download Fees</button>
    </div>

    <table border="1" width="100%">
      <thead>
        <tr>
          <th>Month</th><th>Fees</th><th>Paid</th>
          <th>Due</th><th>Status</th><th>Save</th>
        </tr>
      </thead>
      <tbody id="feesExcelBody"></tbody>
    </table>

    <div style="margin-top:10px;font-weight:bold">
      Total Paid: ‚Çπ<span id="totalPaid">0</span> |
      Total Due: ‚Çπ<span id="totalDue">0</span>
    </div>
  </div>
</div>

<!-- ================= STUDENT EDIT ================= -->
<div id="studentEditModal" class="modal">
  <div class="modal-content" style="max-width:400px">
    <span class="close">&times;</span>
    <h3>‚úèÔ∏è Edit Student</h3>

    <img id="edit_photo_preview" width="80" style="border-radius:50%"><br>
    <input type="file" id="edit_photo_file" accept="image/*"><br><br>

    <input id="edit_id" disabled><br><br>
    <input id="edit_class" placeholder="Class"><br><br>
    <input id="edit_name" placeholder="Student Name"><br><br>
    <input id="edit_parent" placeholder="Parent Name"><br><br>
    <input id="edit_mobile" placeholder="Mobile"><br><br>
    <input id="edit_parent_mobile" placeholder="Parent Mobile"><br><br>

    <button onclick="updateStudentProfile()">‚úÖ Update</button>
  </div>
</div>

<div id="classExamModal" class="modal" style="display:none;">
    <div class="modal-content" style="width: 90%; max-width: 1000px;">
        <span class="close" onclick="this.closest('.modal').style.display='none'">&times;</span>
        <h2>üìù Bulk Exam Management</h2>
        
        <div style="background: #f4f4f4; padding: 15px; border-radius: 8px; margin-bottom: 15px; display: flex; gap: 10px; flex-wrap: wrap; align-items: flex-end;">
            <div>
                <label>Class:</label><br>
                <select id="exam_dash_class" onchange="loadExamStudents()"></select>
            </div>
            <div>
                <label>Year:</label><br>
                <select id="exam_dash_year" onchange="loadExamStudents()"></select>
            </div>
            <div>
                <label>Subject Name:</label><br>
                <input type="text" id="bulk_subject" placeholder="e.g. Maths / Final Exam">
            </div>
            <div>
                <label>Total Marks:</label><br>
                <input type="number" id="bulk_total_marks" placeholder="100">
            </div>
            <div>
                <label>Exam Date:</label><br>
                <input type="date" id="bulk_exam_date">
            </div>
            <button onclick="applyBulkSettings()" style="background:#00b894; color:white;">Apply to All</button>
        </div>

        <table border="1" style="width:100%; border-collapse: collapse; text-align: center;">
            <thead>
                <tr style="background:#dfe6e9;">
                    <th>Photo</th>
                    <th>ID & Name</th>
                    <th>Exam Date</th>
                    <th>Subject</th>
                    <th>Total Marks</th>
                    <th>Obtained Marks</th>
                    <th>Division</th>
                </tr>
            </thead>
            <tbody id="examDashboardBody"></tbody>
        </table>

        <div style="margin-top:20px; display:flex; gap:10px;">
            <button onclick="saveAllResults()" style="background:#0984e3; color:white; padding:10px 20px;">üì¢ Public Result (Save All)</button>
            <button onclick="cancelAllExams()" style="background:#d63031; color:white; padding:10px 20px;">üö´ Cancel Exam (Clear All)</button>
        </div>
    </div>
</div>
Step 2: AdminScript.js mein ye code niche add karein
JavaScript

// Modal Open aur Filters taiyar karna
function openClassExamModal() {
    document.getElementById("classExamModal").style.display = "block";
    const clsSelect = document.getElementById("exam_dash_class");
    const yrSelect = document.getElementById("exam_dash_year");

    clsSelect.innerHTML = '<option value="">Select Class</option>';
    window.classList.forEach(c => clsSelect.innerHTML += `<option>${c}</option>`);

    yrSelect.innerHTML = '<option value="">Select Year</option>';
    const cy = new Date().getFullYear();
    for (let y = cy; y >= 2018; y--) yrSelect.innerHTML += `<option>${y}</option>`;
}

// Students Load karna
async function loadExamStudents() {
    const cls = document.getElementById("exam_dash_class").value;
    const yr = document.getElementById("exam_dash_year").value;
    if (!cls || !yr) return;

    let students = await (await fetch(API + '/api/get-students')).json();
    students = students.filter(s => s.student_class === cls && new Date(s.joining_date).getFullYear() == yr);

    const body = document.getElementById("examDashboardBody");
    body.innerHTML = "";

    students.forEach(s => {
        body.innerHTML += `
        <tr data-id="${s.student_id}">
            <td><img src="${s.photo || ''}" width="40" onerror="handleImgError(this)" style="border-radius:4px;"></td>
            <td><b>${s.student_name}</b><br><small>${s.student_id}</small></td>
            <td><input type="date" class="row-date" value="${s.exam_date || ''}"></td>
            <td><input type="text" class="row-subject" value="${s.parent_mobile || ''}" placeholder="Subject"></td> <td><input type="number" class="row-total" value="${s.total_marks || ''}" style="width:60px"></td>
            <td><input type="number" class="row-obt" value="${s.obtained_marks || ''}" style="width:60px" oninput="updateRowDiv(this)"></td>
            <td class="row-div">${calculateDivision(s.obtained_marks, s.total_marks)}</td>
        </tr>`;
    });
}

// Bulk Apply Button Logic
function applyBulkSettings() {
    const sub = document.getElementById("bulk_subject").value;
    const total = document.getElementById("bulk_total_marks").value;
    const date = document.getElementById("bulk_exam_date").value;

    document.querySelectorAll("#examDashboardBody tr").forEach(row => {
        if (sub) row.querySelector(".row-subject").value = sub;
        if (total) row.querySelector(".row-total").value = total;
        if (date) row.querySelector(".row-date").value = date;
    });
}

// Division auto update on typing marks
function updateRowDiv(input) {
    const row = input.closest('tr');
    const obt = input.value;
    const total = row.querySelector(".row-total").value;
    row.querySelector(".row-div").innerText = calculateDivision(obt, total);
}

// PUBLIC RESULT: Sabka data update karna
async function saveAllResults() {
    if(!confirm("Kya aap sabhi students ka result update karna chahte hain?")) return;
    
    const rows = document.querySelectorAll("#examDashboardBody tr");
    for (let row of rows) {
        const data = {
            student_id: row.dataset.id,
            exam_date: row.querySelector(".row-date").value,
            total_marks: row.querySelector(".row-total").value,
            obtained_marks: row.querySelector(".row-obt").value
        };
        await fetch(API + '/api/update-student-data', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
    }
    alert("Sabhi Results Update ho gaye! ‚úÖ");
}

// CANCEL EXAM: Sabka data clear karna
async function cancelAllExams() {
    if(!confirm("CAUTION: Kya aap puri class ka exam data delete karna chahte hain?")) return;

    const rows = document.querySelectorAll("#examDashboardBody tr");
    for (let row of rows) {
        const data = {
            student_id: row.dataset.id,
            exam_date: "",
            total_marks: "",
            obtained_marks: ""
        };
        await fetch(API + '/api/update-student-data', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
    }
    alert("Exam data clear kar diya gaya! üóëÔ∏è");
    loadExamStudents();
}

  
<footer class="magical-footer">
  <div class="social-icons">
    <a id="foot-whatsapp"><i class="fab fa-whatsapp"></i></a>
    <a id="foot-facebook"><i class="fab fa-facebook"></i></a>
    <a id="foot-gmail"><i class="fas fa-envelope"></i></a>
    <a id="foot-call"><i class="fas fa-phone-alt"></i></a>
  </div>
  <p id="foot-help"></p>
</footer>

<script src="adminscript.js"></script>
</body>
</html>
